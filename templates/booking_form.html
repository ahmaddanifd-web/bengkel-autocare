{% extends "base.html" %}

{% block title %}Pesan Layanan - Bengkel AutoCare{% endblock %}

{% block extra_css %}
<style>
    .form-section {
        padding: 30px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .form-group-header {
        color: #1a73e8;
        font-weight: 700;
        margin-top: 25px;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 3px solid #1a73e8;
    }

    .info-card {
        background: linear-gradient(135deg, #f8f9fa 0%, #e8eef7 100%);
        border-left: 4px solid #1a73e8;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 15px;
    }

    .info-card h6 {
        color: #1a73e8;
        font-weight: 700;
        margin-bottom: 10px;
    }

    .timeline {
        counter-reset: step-counter;
        list-style: none;
        padding: 0;
    }

    .timeline li {
        counter-increment: step-counter;
        margin-bottom: 20px;
        padding-left: 50px;
        position: relative;
    }

    .timeline li::before {
        content: counter(step-counter);
        position: absolute;
        left: 0;
        top: 0;
        background: linear-gradient(135deg, #1a73e8, #1565c0);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        box-shadow: 0 2px 8px rgba(26, 115, 232, 0.3);
    }

    .step-label {
        font-weight: 700;
        color: #1a73e8;
        margin-bottom: 5px;
    }

    .step-desc {
        color: #666;
        font-size: 0.95rem;
    }
</style>
{% endblock %}

{% block content %}
<h1 class="mb-4"><i class="bi bi-calendar-check"></i> Pesan Layanan Bengkel</h1>

<div class="row">
    <div class="col-lg-8">
        <div class="form-section">
            <form method="post">
                {% csrf_token %}
                
                <!-- Step 1: Pilih Kendaraan -->
                <div class="form-group-header">
                    <i class="bi bi-car-front"></i> Langkah 1: Pilih Kendaraan Anda
                </div>
                <div class="mb-4">
                    <label for="id_kendaraan" class="form-label">Pilih Kendaraan yang akan diperbaiki</label>
                    <select class="form-select form-select-lg" id="id_kendaraan" name="kendaraan" required>
                        <option value="">-- Pilih Kendaraan --</option>
                        {% for kendaraan in kendaraan_user %}
                            <option value="{{ kendaraan.id }}">
                                {{ kendaraan.merk }} {{ kendaraan.model }} ({{ kendaraan.nomor_plat }})
                            </option>
                        {% empty %}
                            <option value="" disabled>❌ Tidak ada kendaraan terdaftar. Tambahkan di profil Anda.</option>
                        {% endfor %}
                    </select>
                    {% if not kendaraan_user %}
                    <small class="text-muted d-block mt-2">
                        <i class="bi bi-info-circle"></i> Anda perlu mendaftarkan kendaraan terlebih dahulu.
                    </small>
                    {% endif %}
                </div>

                <!-- Step 2: Pilih Layanan -->
                <div class="form-group-header">
                    <i class="bi bi-tools"></i> Langkah 2: Pilih Layanan
                </div>
                <div class="mb-4">
                    <label for="id_layanan" class="form-label">Layanan yang Anda butuhkan</label>
                    <select class="form-select form-select-lg" id="id_layanan" name="layanan" required>
                        <option value="">-- Pilih Layanan --</option>
                        {% for layanan in layanan_list %}
                            <option value="{{ layanan.id }}" title="{{ layanan.deskripsi }}">
                                {{ layanan.nama }} • Rp {{ layanan.harga_dasar|floatformat:0 }} • {{ layanan.durasi_estimasi }} menit
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Step 3: Tanggal dan Jam -->
                <div class="form-group-header">
                    <i class="bi bi-calendar3"></i> Langkah 3: Tentukan Waktu
                </div>
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <label for="id_tanggal" class="form-label">Tanggal Booking</label>
                        <input type="date" class="form-control form-control-lg" id="id_tanggal" name="tanggal" required min="{% now 'Y-m-d' %}">
                    </div>
                    <div class="col-md-6 mb-4">
                        <label for="id_jam" class="form-label">Jam</label>
                        <input type="time" class="form-control form-control-lg" id="id_jam" name="jam" required>
                    </div>
                </div>

                <!-- Step 4: Keluhan (Optional) -->
                <div class="form-group-header">
                    <i class="bi bi-chat-left-text"></i> Langkah 4: Jelaskan Keluhan (Opsional)
                </div>
                <div class="mb-4">
                    <label for="id_keluhan" class="form-label">Deskripsi Keluhan Kendaraan</label>
                    <textarea class="form-control" id="id_keluhan" name="keluhan" rows="5" 
                              placeholder="Jelaskan detail keluhan kendaraan Anda... (misal: mesin berisik, AC tidak dingin, dll)"></textarea>
                </div>

                <!-- Submit Button -->
                <div class="d-grid gap-2 pt-3">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="bi bi-arrow-right-circle"></i> Lanjutkan ke Pembayaran
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="col-lg-4">
        <!-- Info Card -->
        <div class="info-card">
            <h6><i class="bi bi-lightbulb"></i> Cara Pesan</h6>
            <ul class="timeline">
                <li>
                    <div class="step-label">Pilih Kendaraan</div>
                    <div class="step-desc">Pilih salah satu kendaraan terdaftar Anda</div>
                </li>
                <li>
                    <div class="step-label">Pilih Layanan</div>
                    <div class="step-desc">Tentukan jenis perbaikan yang Anda butuhkan</div>
                </li>
                <li>
                    <div class="step-label">Tentukan Waktu</div>
                    <div class="step-desc">Pilih tanggal dan jam yang tersedia</div>
                </li>
                <li>
                    <div class="step-label">Konfirmasi & Bayar</div>
                    <div class="step-desc">Selesaikan pembayaran untuk mengamankan booking</div>
                </li>
            </ul>
        </div>

        <!-- Contact Info -->
        <div class="card">
            <div class="card-header" style="background: linear-gradient(135deg, #1a73e8 0%, #1565c0 100%); color: white;">
                <h6 class="card-title mb-0"><i class="bi bi-telephone"></i> Hubungi Kami</h6>
            </div>
            <div class="card-body">
                <p class="mb-2">
                    <strong><i class="bi bi-phone"></i> Telepon:</strong><br>
                    <a href="tel:+6213001234567">(021) 300-1234</a>
                </p>
                <p class="mb-2">
                    <strong><i class="bi bi-envelope"></i> Email:</strong><br>
                    <a href="mailto:info@bengkel.local">info@bengkel.local</a>
                </p>
                <p>
                    <strong><i class="bi bi-clock"></i> Jam Operasional:</strong><br>
                    Senin - Jumat: 08:00 - 17:00<br>
                    Sabtu: 08:00 - 15:00<br>
                    Minggu: Tutup
                </p>
            </div>
        </div>

        <!-- FAQ Card -->
        <div class="card mt-3">
            <div class="card-header" style="background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%); color: white;">
                <h6 class="card-title mb-0"><i class="bi bi-question-circle"></i> FAQ</h6>
            </div>
            <div class="card-body">
                <p><strong>Berapa lama proses booking?</strong></p>
                <p class="text-muted text-sm">Proses booking hanya membutuhkan beberapa menit saja.</p>
                
                <p class="mt-3"><strong>Apakah bisa membatalkan booking?</strong></p>
                <p class="text-muted text-sm">Ya, Anda bisa membatalkan hingga 24 jam sebelum jadwal.</p>
                
                <p class="mt-3"><strong>Apakah ada garansi?</strong></p>
                <p class="text-muted text-sm">Ya, semua pekerjaan ditanggung dengan garansi kepuasan.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
